service: nosolopau-siestacms
provider:
  name: aws
  runtime: nodejs12.x
  region: ${env:AWS_REGION}
  stage: ${opt:stage, env:ENV, 'dev'}
  environment:
    USE_S3: true
    POSTS_S3_BUCKET: siestacms-posts-${self:provider.stage}
plugins:
  - serverless-offline
  - serverless-domain-manager
functions:
  app:
    handler: src/index.handler
    events:
      - http: ANY /
      - http: 'ANY {proxy+}'
custom:
  serverless-offline:
    noPrependStageInUrl: true
  customDomain:
    domainName: ${self:provider.stage}.siestacms.com
    certificateName: '*.siestacms.com'
    basePath: ''
    stage: ${self:provider.stage}
    createRoute53Record: true
    endpointType: 'regional'
    autoDomain: false
